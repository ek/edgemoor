package wolken.edgemoor {		import flash.events.Event;	import flash.events.EventDispatcher;			public class EdgemoorLoader extends EventDispatcher {				private var _config:EdgemoorConfig;		private var i:int;		private var currentIndex:int;		private var _frames:Array;		private var _states:Array;				private var _status:String;				public var images:Array;				public function EdgemoorLoader( config ) {						images = new Array();			currentIndex = 0;						_config = config;						_config.addEventListener( Event.COMPLETE, configComplete );						}				private function configComplete(event:Event):void {			// config is completely setup			// start loading			_frames = _config.introFrames;			_states = _config.states;						var imageURL:String;			// add the image loaders to the images array			for(i=0;i<_frames.length; i++) {				imageURL =  _frames[i]['url'];				images.push(new ImageLoader( imageURL ));			}						// add the image loaders for the states to the images array			for(i=0;i<_states.length; i++) {				imageURL =  _states[i]['url'];								images.push(new ImageLoader( imageURL ));			}									// start the loading sequence			_status = "loading";			loadNextImage(event);					}		private function loadNextImage(event:Event):void {						if(images.length > currentIndex ) {								// load the image				//trace('loading ' + currentIndex);				images[currentIndex].loadImage();				images[currentIndex].addEventListener( Event.COMPLETE, loadNextImage );								currentIndex ++;						}						checkStatus();					}		public function get status():String {			return _status;		}		private function checkStatus():void {			if( _config.playIntroWhenLoaded == currentIndex ) {				_status = "intro";				dispatchEvent( new Event(Event.CHANGE) );			} else if( currentIndex >= images.length ) {				_status = "complete";				dispatchEvent( new Event( Event.COMPLETE ) );			}		}		}}